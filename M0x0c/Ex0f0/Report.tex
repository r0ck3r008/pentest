\documentclass[10pt,a4paper]{article}

\usepackage[a-1b]{pdfx} %high quality pdf
\usepackage{datetime}
\usepackage{numprint}
\usepackage{palatino}
\usepackage{authblk}
\usepackage[margin=0.75in]{geometry}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{titlesec}
\usepackage{listings}

\pdfgentounicode=1

\setlength{\parindent}{2em}
%\setlength{\parskip}{1em}
\renewcommand{\baselinestretch}{1.1}

\begin{document}

\nplpadding{2}
\newdateformat{isodate}{\THEYEAR-\numprint{\THEMONTH}-\numprint{\THEDAY}}

\title{Penetration Testing Report for Ex0f0\\ \large{\textit{Codename: `LinuxIsBroken'}}}
\author{Naman Arora}
\date{\isodate\today}

\maketitle
\begin{figure}[h!]
	\includegraphics[width=\textwidth]{pics/sudoers.png}
        \caption{Insecure permissions for \textit{`/etc/sudoers'}}
        \label{sudoers}
\end{figure}
\section{Finding: Insecure Permissions for \textit{`/etc/sudoers'}}
        \subsection{Risk Rating: 4.0}
        Non privileged user might view \textit{sudo} configurations.
        \subsection{Vulnerability Description}
        A user with restricted \textit{sudo} access may view and exploit permissions by looking at the \textit{sudoers} file.
        \subsection{Confirmation Method}
        It can be confirmed using long listing the file path (Fig \ref{sudoers}).
        \subsection{Remediation}
        The \textit{sudoers} file must always have -r------ or 400 permissions set.

\newpage

\begin{figure}[h!]
	\includegraphics[width=\textwidth]{pics/getfacl.png}
        \caption{Insecure ACL permissions for \textit{`/bin/ps'}}
        \label{getfacl}
\end{figure}
\section{Finding: Inappropriate ACL for \textit{`/bin/ps'}}
        \subsection{Risk Rating: 5.0}
        The user \textit{m.mason} has write access to \textit{`bin/ps'} granted by extra set of ACL permissions.
        \subsection{Vulnerability Description}
        An unprivileged user may write to/modify the binary owned by \textit{root}.
        \subsection{Confirmation Method}
        A long listing of the binary path and/or \textit{getfacl} on the binary path reveal the incorrectly set ACL permissions (Fig. \ref{getfacl}).
        \subsection{Remediation}
        Remove user \textit{m.mason's} write access to the binary \textit{`/bin/ps'}.

\begin{figure}[h!]
	\includegraphics[width=\textwidth]{pics/sudo.png}
        \caption{CVE-2019-14287}
        \label{sudo}
\end{figure}
\section{Finding: \href{https://www.sudo.ws/alerts/minus_1_uid.html}{Potential Bypass of Runas User restrictions (CVE-2019-14287)}}
        \subsection{Risk Rating: 9.0}
        \textit{Sudo} before the version 1.8.28 allows privileged bypassed access to blocked programs.
        \subsection{Vulnerability Description}
        An attacker with access to \textit{Runas ALL}  sudoer account may abuse restricted privileged access to certain binary execution by crafting a special user ID (Fig \ref{sudo}).
        \subsection{Confirmation Method}
        A version print on \textit{sudo} reveals the version number.
        \subsection{Remediation}
        Update \textit{Sudo} to latest stable version.

\newpage
\section{Attack Narrative}
With access to \textit{m.mason} user's account on \textit{10.30.0.32} gained from earlier exploitation, the binary \textit{`/bin/ps'} can be replaced with \textit{`/usr/bin/vim.tiny`}.
Once replaced, the \textit{\href{https://nvd.nist.gov/vuln/detail/CVE-2019-14287}{CVE-2019-14287}} Vulnerability can be exploited to run \textit{`vim'} text editor as root and open the \textit{`/etc/sudoers'} file, like,
\begin{lstlisting}[language=bash]
	>> sudo -u#-1 /bin/ps
\end{lstlisting}
The \textit{`/etc/sudoers'} file then can be edited as root to provide unrestricted access to any user, in this case, \textit{m.mason} (Fig. \ref{sudoers_new}).
\begin{figure}[h!]
	\includegraphics[width=\textwidth]{pics/sudoers_new.png}
        \caption{Unrestricted access to \textit{m.mason}}
        \label{sudoers_new}
\end{figure}
\end{document}
