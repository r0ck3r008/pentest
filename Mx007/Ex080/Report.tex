\documentclass[10pt,a4paper]{article}

\usepackage[a-1b]{pdfx} %high quality pdf
\usepackage{datetime}
\usepackage{numprint}
\usepackage{palatino}
\usepackage{authblk}
\usepackage[margin=0.75in]{geometry}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{titlesec}

\pdfgentounicode=1

\setlength{\parindent}{2em}
%\setlength{\parskip}{1em}
\renewcommand{\baselinestretch}{1.1}

\begin{document}

\titleformat*{\section}{\LARGE\bfseries}
\titleformat*{\subsection}{\large\bfseries}
\titleformat*{\subsubsection}{\small\bfseries}

\nplpadding{2}
\newdateformat{isodate}{\THEYEAR-\numprint{\THEMONTH}-\numprint{\THEDAY}}

\title{Penetration Testing Report for Ex080\\ \large{\textit{Codename: `ThroughTheGate`}}}
\author{Naman Arora\\\small{Pr0b3 LLC}}
\date{\isodate\today}

\maketitle
\section{Technical Report}
During the assessment of the host \textit{172.30.0.3} in the \textit{F4rmc0rp} network, the following vulnerabilities were discovered,
\begin{figure}[h!]
	\includegraphics[width=\textwidth]{../pics/openvas.png}
	\caption{\textit{OpenVAS Scan} for Vulnerable WebService}
	\label{scan}
\end{figure}
\subsection{Unchanged Default Username and Password Combination \textbf{(Score: 10.0)}}
	\subsubsection{Risk Rating: 10.0}
	The hosted webservice can be exploited for firewall penetration by malicious actors.
	\subsubsection{Vulnerability Description}
	The hosted webservice is vulnerable since it has default credentials for the administrator account.
	The webservice being the control panel for a routing software, it may be used by a bad actor to gain access to internal network, bypassing firewall.
	\subsubsection{Confirmation Method}
	The default credentials, \textit{`admin`:`pfsense`} can be used to gain access to admin panel.
	\subsubsection{Remediation}
	Change the password of the \textit{`admin`} account.
\subsection{SSL/TLS Missing \textit{`Secure`} Cookie Attribute \textbf{(Score: 6.4)}}
	\subsubsection{Risk Rating: 6.4}
	The hosted webservice is vulnerable to \textit{`Session SideJacking`} attack which may give full access to remote and unauthenticated user.
	\subsubsection{Vulnerability Description}
	Since the session cookies are set and passed unencrypted, they can be captured by a bad actor while an authorized user is using the service.
	The cookie can then be passed by the bad actor to the service to gain authenticated remote access.
	\subsubsection{Confirmation Method}
	The OpenVAS scan (Fig. \ref{scan}) confirms the vulnerability.
	\subsubsection{Remediation}
	Enable \textit{`secure`} attribute for cookies.
\subsection{Missing \textit{`httpOnly`} Cookie Attribute}
	\subsubsection{Risk Rating: 5.0}
	The webservice is vulnerable to \textit{Session SideJacking} attack by passing cookies via non-HTTP mediums.
	\subsubsection{Vulnerability Description}
	The webservice can be \textit{SideJacked} by a bad actor in possession of a valid session cookie of an authenticated user using non-HTTP mediums.
	\subsubsection{Confirmation Method}
	The OpenVAS scan (Fig. \ref{scan}) confirms the vulnerability.
	\subsubsection{Remediation}
	Enable \textit{`httpOnlu`} attribute for all session cookies.

\subsection{Attack Narrative}
Using the default username and password combination, an attacker can login to the \textit{`pfsense`} control panel on the host \textit{innerouter (IP: 172.30.0.3)}.
Once inside, the attacker may change the \textit{NAT} firewall rules and forward port \textbf{3389} from \textit{herd.f4rmc0rp.com (IP: 10.30.0.98)} to the router for access from outside network.
Since this essentially pokes a hole in the firewall, the attacker may access the RDP session running on the machine using already harvested username and password combination, \textit{In this case, `Brian`:`Sw0****s*`}.

\end{document}
