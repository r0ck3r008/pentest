\documentclass[10pt,a4paper]{article}

\usepackage[a-1b]{pdfx} %high quality pdf
\usepackage{datetime}
\usepackage{numprint}
\usepackage{palatino}
\usepackage{authblk}
\usepackage[margin=0.75in]{geometry}
\usepackage{listings}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{multicol}

\pdfgentounicode=1

%paragraph indentation
\setlength{\parindent}{2em}
%\setlength{\parskip}{1em}
\renewcommand{\baselinestretch}{1.25}

\begin{document}

\nplpadding{2}
\newdateformat{isodate}{\THEYEAR-\numprint{\THEMONTH}-\numprint{\THEDAY}}

\title{Penetration Testing Report for Ex030\\ \large{\textit{Codename: `DNS Reconnaissance`}}}
\author{Naman Arora}
\date{\isodate\today}

\maketitle
\section{Technical Report}
\subsection{Findings}
During the DNS Reconnaissance phase, the following IP blocks were uncovered:
\begin{itemize}
	\item{10.30.0.0/24}
	\item{172.30.0.0/24}
\end{itemize}
Within these IP blocks, the following 11 hosts were spotted to be alive:
\begin{multicols}{2}
\begin{itemize}
	\item{www.f4rmc0rp.com}\\ 172.30.0.128
	\item{innerouter.f4rmc0rp.com}\\ 172.30.0.3
	\item{ns.f4rmc0rp.com}\\ 172.30.0.128
	\item{mail.f4rmc0rp.com}\\ 172.30.0.130
	\item{pop.f4rmc0rp.com}\\ 172.30.0.128
	\item{devbox.f4rmc0rp.com}\\ 10.30.0.32
	\item{pdc.f4rmc0rp.com}\\ 10.30.0.90
	\item{patronum.f4rmc0rp.com}\\ 10.30.0.97
	\item{herd.f4rmc0rp.com}\\ 10.30.0.98
	\item{KEY005-IHIHIWJRhzMTH4qXCCwOuA.f4rmc0rp.com}\\ 10.30.0.102
	\item{linuxserver.f4rmc0rp.com}\\ 10.30.0.128
\end{itemize}
\end{multicols}

\subsection{Attack Narrative}

\subsubsection{Task 01}
The first task is to scan the \textit{www.f4rmc0rp.com} website with \textit{fierce} domain scanner and note down all the domains that it finds.
The following command was issued:\\
\begin{lstlisting}[language=bash]
	$> fierce -dns f4rmc0rp.com
\end{lstlisting}
\begin{figure}[!h]
	\includegraphics[width=\textwidth,scale=0.15]{pentest/fierce_simple.png}
	\caption{Fierce Simple Run}
\end{figure}

\newpage
\subsubsection{Task 02}
The second task was to inspect the source code of the \textit{fierce} scanner to look for its default wordlist.
First, to locate the \textit{fierce} executable,
\begin{lstlisting}[language=bash]
	$> which fierce
\end{lstlisting}
which locates it in \textit{/usr/bin/fierce}.
Then on inspecting the file type of \textit{/usr/bin/fierce} usig \textit{file},
\begin{lstlisting}[language=bash]
	$> file /usr/share/fierce
\end{lstlisting}
it reveals that its a PERL script. Opening it with \textit{vim} and searching for wordlist reveals a file \textit{/usr/share/fierce/hosts.txt}.
\begin{figure}[!h]
	\includegraphics[width=\textwidth]{pentest/fierce_wordlist_hosts.png}
	\caption{Fierce Wordlist}
\end{figure}

\newpage
\subsubsection{Task 03}
The next task was to run \textit{CeWL} against \textit{www.f4rmc0rp.com} to generate a custom word list and use it with unison with the fierce wordlist to find more subdomains.
To execute CeWL,
\begin{lstlisting}[language=bash]
	$> cewl -d 3 -o -w cewl_list.txt www.f4rmc0rp.com
\end{lstlisting}
\begin{figure}[!h]
	\includegraphics[width=\textwidth]{pentest/cewl_wordlist.png}
	\caption{CeWL Wordlist}
\end{figure}

Now using this wordlist with fierce,
\begin{lstlisting}
	$> fierce -wordlist cewl_list.txt -dns f4rmc0rp.com
\end{lstlisting}
\begin{figure}[!h]
	\includegraphics[width=\textwidth]{pentest/fierce_cewl_run.png}
	\caption{Fierce Run with CeWL Wordlist}
\end{figure}


On combining a reverse lookup method provided by \textit{fierce} and using the default \textit{fierce} wordlist merged with the one produced by \textit{CeWL},
\begin{lstlisting}[language=bash]
	$> cat /usr/share/fierce/hosts.txt ./cewl_list.txt > cewl_fierce_list.txt
	$> fierce -wordlist cewl_fierce_list.txt -dns f4rmc0rp.com -traverse 4 -threads 4
\end{lstlisting}
\newpage
This produces a total of 11 hosts, 3 more than combined total of \textit{fierce} default run and \textit{fierce} with \textit{CeWL} wordlist run.
\begin{figure}[h!]
	\includegraphics[width=\textwidth]{pentest/fierce_cewl_traverse_run.png}
	\caption{Fierce Final Run}
\end{figure}

\newpage
\subsubsection{Task 04}
The next task was to determine how \textit{fierce} could have enumerated the hosts that it did.
The three methods used were \textit{Reverse Lookup}, \textit{from CeWL wordlist}, \textit{default fierce wordlist}.
The following observations were made,
\begin{multicols}{2}
\begin{itemize}
	\item{www.f4rmc0rp.com 172.30.0.128}\\
		Via default \textit{fierce} wordlist.
	\item{innerouter.f4rmc0rp.com 172.30.0.3}\\
		Via reverse lookup.
	\item{ns.f4rmc0rp.com 172.30.0.128}\\
		Via default \textit{fierce} wordlist.
	\item{mail.f4rmc0rp.com 172.30.0.130}\\
		Via default \textit{fierce} wordlist.
	\item{pop.f4rmc0rp.com 172.30.0.128}\\
		Via default \textit{fierce} wordlist.
	\item{devbox.f4rmc0rp.com 10.30.0.32}\\
		Via reverse lookup.
	\item{pdc.f4rmc0rp.com 10.30.0.90}\\
		Via default \textit{fierce} wordlist.
	\item{patronum.f4rmc0rp.com 10.30.0.97}\\
		Via \textit{CeWL} wordlist.
	\item{herd.f4rmc0rp.com 10.30.0.98}\\
		Via reverse lookup.
	\item{KEY005-IHIHIWJRhzMTH4qXCCwOuA.f4rmc0rp.com 10.30.0.102}\\
		Via reverse lookup.
	\item{linuxserver.f4rmc0rp.com 10.30.0.128}\\
		Via reverse lookup.
\end{itemize}
\end{multicols}
The conclusions that reverse lookups were used by \textit{fierce} was derived by analyzing the traffic using the \textit{tcpdump}.
Even when given enough time, fierce could not have found out these domains in any other way since even brute force technique used by amass, in next subsection, could only enumerate 5 such subdomains.

\newpage
\subsubsection{Task 05}
The very last task is to comapre the results obtained from a combination of all three types of lookups to the results from amass scanner.
To execute amass scanner,
\begin{lstlisting}[language=bash]
	$> amass enum -r ns.f4rmc0rp.com -d f4rmc0rp.com -ip -brute -src
\end{lstlisting}
was used.
Amass was limited since it derives it \textit{`wordlist`} from well known DNS servers present on the internet which its restricted from accessing.
It could only find 5 domains.
\begin{figure}[!h]
	\includegraphics[width=\textwidth]{pentest/amass_run1.png}
	\caption{Amass Run}
\end{figure}
The team meeting URL \href{https://meet.jit.si/ex0x30}{https://meet.jit.si/ex0x30}.

\subsection{Risk Analysis}
The risk involved so far in the information obtained is minimal at maximum.
DNS zone transfer was attempted which failed promptly during each type of analysis.

\end{document}
